apiVersion: networking.istio.io/v1alpha3
kind: HTTPRoute
metadata:
  name: dynamic-route
  namespace: gateway-api
spec:
  parentRefs:
    - name: istio-ingressgateway # Referencing the Gateway from above
  hosts:
    - "*.localhost" # Matches all subdomains of localhost
  rules:
    - matches:
        - headers:
            ":authority":
              stringMatch:
                exact: "app1.localhost" # Match specific subdomain, e.g., app1.localhost
      backendRefs:
        - name: app1
          port: 80
    - matches:
        - headers:
            ":authority":
              stringMatch:
                exact: "app2.localhost" # Match another subdomain, e.g., app2.localhost
      backendRefs:
        - name: app2
          port: 80
